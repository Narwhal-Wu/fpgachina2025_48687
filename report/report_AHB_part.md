# FPGA创新设计大赛 AMD赛道 - 自主选题初级赛道设计报告

**竞赛名称：** 2025年全国大学生嵌入式芯片与系统设计竞赛——FPGA创新设计大赛 AMD赛道
**赛道类型：** 自主选题 - 初级赛道
**项目名称：** [请填写项目名称]
**提交日期：** [YYYY-MM-DD]

---

## 摘要

[300-500字的项目摘要，包括：研究背景、技术方案、实验结果和结论]

**关键词：** [3-5个关键词]

## 1. 项目概述

### 1.1 选题背景与意义

[详细描述选题的背景、现实意义和应用价值]

### 1.2 项目目标

**功能目标：**

- [描述项目要实现的主要功能]
- [描述项目的技术指标要求]

**学习目标：**

- [描述通过本项目要掌握的FPGA设计技能]
- [描述要提升的工程实践能力]

### 1.3 技术规格

- **目标器件：** [选用的AMD FPGA/ZYNQ器件型号]
- **开发环境：** [Vivado/Vitis，如Vivado 2024.1]
- **编程语言：** [Verilog/VHDL/HLS C++]
- **验证平台：** [仿真环境和硬件平台]
- **应用领域：** [如数字信号处理、图像处理、通信等]

---

## 2. 需求分析与系统设计

### 2.1 功能需求分析

[详细分析项目的功能需求]

实现能够与AHB-Lite协议适配的访存模块包括用于vivado bram转换AHB-Lite协议的bram_controller,跟简易的AHB_arbiter用于总线仲裁，使用AMBA总线协议提升项目模块的可复用性让模块能够更好地进行扩展跟适配不同模块。
**核心功能模块：**

1. **功能模块1：** [详细描述]
2. **功能模块2：** [详细描述]
3. **AHB-Lite存储系统：** 
     - 地址译码和数据路由
     - 支持字节、半字、字访问
     - 传输仲裁和控制

**性能需求：**

- 工作频率：[MHz]
- 数据吞吐率：支持AHB pipeline能够实现连续读写
- 延迟要求：单时钟周期存储读写延迟，符合AHB接口标准
- 精度要求：[具体指标]

### 2.2 系统架构设计

#### 2.2.1 顶层架构

[描述整体系统架构，重点展示FPGA基本设计能力]

```
[系统架构图]
┌─────────────────────────────────────────────────────┐
│                    顶层模块                          │
├─────────────┬─────────────┬─────────────┬─────────────┤
│  输入接口    │   控制逻辑   │   数据处理   │  输出接口    │
│  模块       │   模块      │   模块      │   模块      │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

#### 2.2.2 状态机设计

在AHB_bram_controller模块使用状态机对当前周期跟前一周期主机发起的传输事务进行标记，反映当前控制模块数据传输状态，实现当AHB流水线传输当读请求紧随着写请求发起，BRAM不能及时处理数据，在不产生等待的情况下符合AHB协议正确读写数据。具体而言，代码显式展现的状态有IDLE，WRITE，READ跟FREE。而在实际的控制中基于前一时钟周期跟当前状态进行控制，实际上实现了IDLE，WRITE，READ，WRITE -> READ(BUSY)，READ -> WRITE(FREE)，NO TASK(FREE)六个状态。这么做的原因是标准的状态机需要在状态转换信号的下一个时钟周期进行状态转换，而这样不能满足当作为状态转换信号的控制信号到来就直接对其进行响应，进行对应控制的设计要求，因此采用这种设计逻辑。

**状态转换图：**

![AHB_bram_controller状态机](figure/fsm_AHB.svg)

**状态说明：**

- IDLE：代表当前HRESETn为低，存储读写模块在被重置，没有在工作状态
- WRITE：代表当前主机发起一个写传输请求，在等效状态中用于判断下一步状态跳转
- READ：代表当前主机发起一个读传输请求，在等效状态中用于判断下一步状态跳转
- FREE：代表读写模块在工作状态，主机没有发起传输任务。代表存储读写模块在工作且主机没有发起读写传输请求，如果之前有由主机发起写传输请求之后连续发起读传输请求产生的未决事务写传输，此时能够在读传输的数据阶段进行写操作，完成之前的写传输，释放寄存器。
- WRITE -> READ (BUSY) *等效状态* 代表主机发起写传输请求之后连续发起读传输请求，由于BRAM读操作需要一个时钟周期而AHB接口协议读操作同样也是一个时钟周期，为了不拉低HREADYOUT产生等待减慢主机速度，这时候控制BRAM先进行读操作而将当前写操作存入寄存器进行缓冲，等BRAM空闲再发起当前写操作。而在等待BRAM有空闲能够进行之前的写操作的过程中，如果再次有读操作访问了之前写操作对应的地址会基于写操作的偏移跟写数据跟读出数据组合输出读数据实现前推避免读数据错误。
- READ -> WRITE (FREE) *等效状态* 代表主机发起读传输请求之后连续发起写传输请求，由于读传输请求在控制阶段已经被BRAM处理完在数据阶段输出数据，而写传输在控制阶段不需要对BRAM进行操作。因此如果之前有由主机发起写传输请求之后连续发起读传输请求产生的未决事务写传输，此时能够在读传输的数据阶段进行写操作，完成之前的写传输，释放寄存器。
- NO TASK (FREE) *等效状态* 跟实际状态FREE是同一个状态

**展示外围模块AHB_bram_controller状态机设计而不是核心控制逻辑的原因：**
cpu部分采用5级流水线架构代码内部没有标准的状态机部分

#### 2.2.3 时序设计

对于cpu跟外设BRAM的数据读写时序，参照AMBA AHB协议进行实现，将数据传输分成控制阶段跟数据阶段，实现在控制阶段下一个时钟周期进行数据传输，每个传输需要2个时钟周期，但能够通过流水线形式运行这样每个周期都有控制信号跟数据传输。

### 2.3 接口设计

采用AMBA AHB接口协议进行设计，但未对所有信号进行处理，因当前系统只需要满足APB功能使用流水线传输就能满足cpu数据传输要求，节省资源。但保留AHB准备下一步增加burst跟cache部分提升项目速度。

**输入接口规格：**

- 数据位宽：[位数]
- 时钟域：[时钟频率]
- 控制信号：[信号列表]

**输出接口规格：**

- 数据位宽：[位数]
- 时序关系：[描述]
- 状态指示：[信号说明]

---

## 3. 详细设计与实现

### 3.1 核心算法设计

[描述项目中用到的核心算法]

**算法原理：**
[用数学公式或伪代码描述算法]

**硬件实现策略：**
[描述如何将算法映射到硬件]

### 3.2 关键模块设计

#### 3.2.1 [模块名称1]

**功能描述：**
[详细描述模块功能]

**端口定义：**

```verilog
module [模块名称] (
    input  wire        clk,
    input  wire        rst_n,
    input  wire [7:0]  data_in,
    output reg  [7:0]  data_out,
    output reg         valid_out
);
```

**逻辑设计：**
[描述模块内部逻辑设计]

#### 3.2.2 [模块名称2]

[按相同格式描述其他关键模块]

### 3.3 资源使用设计

[描述如何合理使用FPGA资源]

**逻辑资源规划：**

- LUT使用策略：[描述]
- 寄存器使用：[描述]
- 时钟资源：[描述]

**存储资源规划：**

- BRAM使用：[描述用途和大小]
- 分布式RAM：[描述]

---

## 4. LLM 辅助优化记录

### 4.1 设计阶段LLM辅助

#### 4.1.1 架构设计咨询

**优化目标：** 确定最佳系统架构

**用户输入：**

```
我正在设计一个[项目类型]，需要实现[具体功能]。目标器件是[FPGA型号]，
主要性能要求是[性能指标]。请帮我分析最适合的系统架构设计方案，
并给出模块划分建议。

具体需求：
1. [需求1]
2. [需求2]
3. [需求3]

请提供架构建议和关键设计要点。
```

**LLM回答：**

```
[粘贴LLM的完整回答]
```

**采用建议：**
[列出实际采用的架构建议]

#### 4.1.2 状态机设计优化

**优化目标：** 优化控制逻辑设计

**用户输入：**

```
我需要设计一个控制[具体功能]的状态机，主要控制流程包括：
[描述控制流程]

当前设计的状态机有[X]个状态，但感觉状态转换比较复杂。
请帮我优化状态机设计，简化控制逻辑。

[当前状态机描述或代码]
```

**LLM回答：**

```
[粘贴LLM的回答]
```

**优化实施：**
[描述实际的状态机优化结果]

### 4.2 实现阶段LLM辅助

#### 4.2.1 代码优化

**优化目标：** 提升代码质量和性能

**用户输入：**

```
以下是我的[模块名称]Verilog代码，主要功能是[功能描述]。
请帮我检查代码质量，并提供优化建议，特别是在时序、面积和功耗方面。

[粘贴代码]

请重点关注：
1. 时序优化
2. 资源使用优化
3. 代码规范性
```

**LLM回答：**

```
[粘贴LLM的回答]
```

**代码改进：**

```verilog
// 优化前代码片段
[原始代码]

// 优化后代码片段
[改进后代码]
```

#### 4.2.2 时序优化

**优化目标：** 解决时序违例

**用户输入：**

```
我的设计在综合后出现时序违例，关键路径延迟为[X]ns，
目标时钟周期为[Y]ns。违例路径主要在[描述路径]。

请帮我分析时序违例的原因，并提供优化建议。

[时序报告或相关信息]
```

**LLM回答：**

```
[粘贴LLM的回答]
```

**时序优化措施：**
[描述实际采取的时序优化措施]

### 4.3 调试阶段LLM辅助

#### 4.3.1 仿真问题解决

**问题描述：** [描述遇到的仿真问题]

**用户输入：**

```
在仿真过程中遇到以下问题：
[详细描述问题现象]

仿真波形显示：
[描述关键信号的异常行为]

请帮我分析可能的原因并提供调试建议。
```

**LLM回答：**

```
[粘贴LLM的回答]
```

**问题解决：**
[描述问题的最终解决方案]

### 4.4 LLM辅助总结

**效果评估：**

- 设计效率提升：[具体描述]
- 代码质量改善：[具体描述]
- 学习效果：[描述通过LLM辅助学到的知识]

**使用心得：**

- 有效的prompt技巧：[总结]
- LLM擅长的领域：[总结]
- 需要人工判断的方面：[总结]

---

## 5. 仿真验证与测试

### 5.1 仿真环境搭建

**仿真工具：** [如ModelSim, Vivado Simulator]
**测试平台：** [描述测试环境]

### 5.2 功能验证

#### 5.2.1 单元测试

[描述各个模块的单元测试]

**测试模块1：**

- 测试目标：[描述]
- 测试用例：[列出关键测试用例]
- 测试结果：✅ 通过 / ❌ 未通过

#### 5.2.2 集成测试

[描述系统级集成测试]

**测试场景：**
[描述各种测试场景]

**测试结果分析：**
[分析测试结果]

### 5.3 时序验证

[描述时序分析结果]

**关键路径分析：**

- 最长路径延迟：[ns]
- 建立时间裕量：[ns]
- 保持时间裕量：[ns]

### 5.4 硬件验证（如适用）

[如果进行了板级验证，描述验证过程]

---

## 6. 综合实现结果

### 6.1 资源使用报告

| 资源类型 | 使用数量 | 总数量 | 利用率 |
| -------- | -------- | ------ | ------ |
| LUT      | [数量]   | [总数] | [%]    |
| FF       | [数量]   | [总数] | [%]    |
| BRAM     | [数量]   | [总数] | [%]    |
| DSP      | [数量]   | [总数] | [%]    |
| IO       | [数量]   | [总数] | [%]    |

### 6.2 时序性能报告

| 时序指标 | 目标值 | 实际值 | 裕量  |
| -------- | ------ | ------ | ----- |
| 时钟频率 | [MHz]  | [MHz]  | [MHz] |
|          |        |        |       |

### 6.3 功耗分析（可选）

| 功耗类型 | 功耗值 |
| -------- | ------ |
| 静态功耗 | [W]    |
| 动态功耗 | [W]    |
| 总功耗   | [W]    |

---

## 7. 创新点与特色

### 7.1 设计创新点

[描述项目的创新之处，注重体现FPGA基本设计能力的创新应用]

1. **逻辑设计创新：** [描述]
2. **状态机设计创新：** [描述]
3. **时序设计创新：** [描述]
4. **接口设计创新：** [描述]

### 7.2 工程实现特色

[描述在工程实现方面的特色]

### 7.3 LLM辅助方法创新

[描述在LLM辅助设计方面的创新做法]

---



## 8. 未来改进方向

### 8.1 当前不足

[客观分析项目的不足之处]

### 8.2 改进计划

[提出具体的改进方案]

### 8.3 后续发展方向

[描述项目的进一步发展可能性]

---

## 9. 结论

### 9.1 项目完成情况

[总结项目的完成情况]

### 9.2 目标达成度

[分析预期目标的达成情况]

### 9.3 项目价值

[总结项目的技术价值和学习价值]

---

## 10. 参考文献

[1] [参考文献1]
[2] [参考文献2]
[3] [参考文献3]

---

## 11. 附录

### 11.1 系统源代码目录树

```
project_root/
├── src/                    # 源代码目录
│   ├── rtl/               # RTL代码
│   │   ├── top_module.v   # 顶层模块
│   │   ├── core/          # 核心模块
│   │   └── utils/         # 工具模块
│   ├── constraints/       # 约束文件
│   │   └── timing.xdc
│   ├── testbench/         # 测试文件
│   │   └── tb_top.v
│   └── scripts/           # 构建脚本
├── docs/                  # 文档目录
├── simulation/            # 仿真结果
└── README.md             # 项目说明
```

### 11.2 关键LLM交互记录

[提供最重要的几次LLM交互记录，展示LLM辅助的核心价值]

**重要交互1：** [交互主题]

- 用户问题：[简化的问题描述]
- LLM建议：[关键建议摘要]
- 实施效果：[具体改进效果]

**重要交互2：** [交互主题]

- 用户问题：[简化的问题描述]
- LLM建议：[关键建议摘要]
- 实施效果：[具体改进效果]
