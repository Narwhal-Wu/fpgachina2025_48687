<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: writeback_module Pages: 1 -->
<svg width="693pt" height="558pt"
 viewBox="0.00 0.00 693.14 558.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 554)">
<title>writeback_module</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-554 689.14,-554 689.14,4 -4,4"/>
<text text-anchor="middle" x="342.57" y="-534.8" font-family="Arial Bold" font-size="14.00">写回模块 (Writeback Stage)</text>
<text text-anchor="middle" x="342.57" y="-519.8" font-family="Arial Bold" font-size="14.00">负责选择写回数据并更新寄存器堆</text>
<g id="clust1" class="cluster">
<title>cluster_inputs</title>
<polygon fill="#f0f8ff" stroke="#4169e1" stroke-width="2" points="28.19,-8 28.19,-383 165.81,-383 165.81,-8 28.19,-8"/>
<text text-anchor="middle" x="97" y="-367.8" font-family="Arial Bold" font-size="14.00">输入信号</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_module</title>
<path fill="#fffaf0" stroke="#ff8c00" stroke-width="3" d="M264,-105C264,-105 362,-105 362,-105 368,-105 374,-111 374,-117 374,-117 374,-235 374,-235 374,-241 368,-247 362,-247 362,-247 264,-247 264,-247 258,-247 252,-241 252,-235 252,-235 252,-117 252,-117 252,-111 258,-105 264,-105"/>
</g>
<g id="clust3" class="cluster">
<title>cluster_outputs</title>
<polygon fill="#f0fff0" stroke="#228b22" stroke-width="2" points="417,-62 417,-263 546.14,-263 546.14,-62 417,-62"/>
<text text-anchor="middle" x="481.57" y="-247.8" font-family="Arial Bold" font-size="14.00">输出信号</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_note</title>
<polygon fill="#fffacd" stroke="#daa520" stroke-dasharray="5,2" points="8,-391 8,-504 186,-504 186,-391 8,-391"/>
<text text-anchor="middle" x="97" y="-398.8" font-family="Arial Bold" font-size="14.00">注意事项</text>
</g>
<!-- CLK -->
<g id="node1" class="node">
<title>CLK</title>
<ellipse fill="#e6f3ff" stroke="#4682b4" stroke-width="2" cx="97" cy="-94" rx="27" ry="18"/>
<text text-anchor="middle" x="97" y="-91.5" font-family="Arial" font-size="10.00">CLK</text>
</g>
<!-- WB_CTRL -->
<g id="node8" class="node">
<title>WB_CTRL</title>
<path fill="#ffe4b5" stroke="#ff8c00" stroke-width="2" d="M351,-165C351,-165 275,-165 275,-165 269,-165 263,-159 263,-153 263,-153 263,-125 263,-125 263,-119 269,-113 275,-113 275,-113 351,-113 351,-113 357,-113 363,-119 363,-125 363,-125 363,-153 363,-153 363,-159 357,-165 351,-165"/>
<text text-anchor="middle" x="313" y="-153" font-family="Arial" font-size="10.00">写回控制单元</text>
<text text-anchor="middle" x="313" y="-142" font-family="Arial" font-size="10.00">• 生成写使能</text>
<text text-anchor="middle" x="313" y="-131" font-family="Arial" font-size="10.00">• rd ≠ x0 检查</text>
<text text-anchor="middle" x="313" y="-120" font-family="Arial" font-size="10.00">• 指令类型检查</text>
</g>
<!-- CLK&#45;&gt;WB_CTRL -->
<g id="edge1" class="edge">
<title>CLK&#45;&gt;WB_CTRL</title>
<path fill="none" stroke="#ff8c00" stroke-width="1.5" d="M122.97,-99.25C154.61,-105.9 210.17,-117.59 252.9,-126.57"/>
<polygon fill="#ff8c00" stroke="#ff8c00" stroke-width="1.5" points="252.4,-130.04 262.91,-128.68 253.84,-123.19 252.4,-130.04"/>
<text text-anchor="middle" x="219" y="-125.8" font-family="Arial" font-size="9.00">时钟</text>
</g>
<!-- MEMWB_ALU -->
<g id="node2" class="node">
<title>MEMWB_ALU</title>
<ellipse fill="#e6f3ff" stroke="#4682b4" stroke-width="2" cx="97" cy="-211" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="97" y="-214" font-family="Arial" font-size="10.00">MEM_WB_alu</text>
<text text-anchor="middle" x="97" y="-203" font-family="Arial" font-size="10.00">ALU结果</text>
</g>
<!-- WB_MUX -->
<g id="node7" class="node">
<title>WB_MUX</title>
<path fill="#ffd700" stroke="#ff8c00" stroke-width="2" d="M354,-239C354,-239 272,-239 272,-239 266,-239 260,-233 260,-227 260,-227 260,-195 260,-195 260,-189 266,-183 272,-183 272,-183 354,-183 354,-183 360,-183 366,-189 366,-195 366,-195 366,-227 366,-227 366,-233 360,-239 354,-239"/>
<text text-anchor="middle" x="313" y="-226.2" font-family="Arial" font-size="11.00">写回数据选择器</text>
<text text-anchor="middle" x="313" y="-214.2" font-family="Arial" font-size="11.00">• ALU 结果</text>
<text text-anchor="middle" x="313" y="-202.2" font-family="Arial" font-size="11.00">• Load 数据</text>
<text text-anchor="middle" x="313" y="-190.2" font-family="Arial" font-size="11.00">• PC + 4</text>
</g>
<!-- MEMWB_ALU&#45;&gt;WB_MUX -->
<g id="edge2" class="edge">
<title>MEMWB_ALU&#45;&gt;WB_MUX</title>
<path fill="none" stroke="#4169e1" stroke-width="2" d="M153.67,-211C183.15,-211 219.45,-211 249.85,-211"/>
<polygon fill="#4169e1" stroke="#4169e1" stroke-width="2" points="249.92,-214.5 259.92,-211 249.92,-207.5 249.92,-214.5"/>
<text text-anchor="middle" x="219" y="-213.8" font-family="Arial" font-size="9.00">ALU</text>
</g>
<!-- MEMWB_DATA -->
<g id="node3" class="node">
<title>MEMWB_DATA</title>
<ellipse fill="#e6f3ff" stroke="#4682b4" stroke-width="2" cx="97" cy="-331" rx="60.62" ry="21.43"/>
<text text-anchor="middle" x="97" y="-334" font-family="Arial" font-size="10.00">MEM_WB_data</text>
<text text-anchor="middle" x="97" y="-323" font-family="Arial" font-size="10.00">Load数据</text>
</g>
<!-- MEMWB_DATA&#45;&gt;WB_MUX -->
<g id="edge3" class="edge">
<title>MEMWB_DATA&#45;&gt;WB_MUX</title>
<path fill="none" stroke="#4169e1" stroke-width="2" d="M145.17,-317.73C158.69,-313.19 173.22,-307.56 186,-301 215.95,-285.62 246.75,-263.75 270.4,-245.42"/>
<polygon fill="#4169e1" stroke="#4169e1" stroke-width="2" points="272.75,-248.03 278.46,-239.1 268.43,-242.52 272.75,-248.03"/>
<text text-anchor="middle" x="219" y="-297.8" font-family="Arial" font-size="9.00">Load</text>
</g>
<!-- MEMWB_PC -->
<g id="node4" class="node">
<title>MEMWB_PC</title>
<ellipse fill="#e6f3ff" stroke="#4682b4" stroke-width="2" cx="97" cy="-271" rx="54.39" ry="21.43"/>
<text text-anchor="middle" x="97" y="-274" font-family="Arial" font-size="10.00">MEM_WB_pc</text>
<text text-anchor="middle" x="97" y="-263" font-family="Arial" font-size="10.00">PC+4</text>
</g>
<!-- MEMWB_PC&#45;&gt;WB_MUX -->
<g id="edge4" class="edge">
<title>MEMWB_PC&#45;&gt;WB_MUX</title>
<path fill="none" stroke="#4169e1" stroke-width="1.5" d="M141.56,-258.79C172.71,-250.05 215.07,-238.18 249.77,-228.45"/>
<polygon fill="#4169e1" stroke="#4169e1" stroke-width="1.5" points="251.12,-231.7 259.81,-225.63 249.23,-224.96 251.12,-231.7"/>
<text text-anchor="middle" x="219" y="-244.8" font-family="Arial" font-size="9.00">PC+4</text>
</g>
<!-- MEMWB_INST -->
<g id="node5" class="node">
<title>MEMWB_INST</title>
<ellipse fill="#e6f3ff" stroke="#4682b4" stroke-width="2" cx="97" cy="-151" rx="58.88" ry="21.43"/>
<text text-anchor="middle" x="97" y="-154" font-family="Arial" font-size="10.00">MEM_WB_inst</text>
<text text-anchor="middle" x="97" y="-143" font-family="Arial" font-size="10.00">指令</text>
</g>
<!-- MEMWB_INST&#45;&gt;WB_MUX -->
<g id="edge5" class="edge">
<title>MEMWB_INST&#45;&gt;WB_MUX</title>
<path fill="none" stroke="#4169e1" stroke-width="1.5" stroke-dasharray="5,2" d="M143.91,-163.87C174.87,-172.55 216.1,-184.11 249.97,-193.61"/>
<polygon fill="#4169e1" stroke="#4169e1" stroke-width="1.5" points="249.2,-197.03 259.77,-196.36 251.09,-190.29 249.2,-197.03"/>
<text text-anchor="middle" x="219" y="-191.8" font-family="Arial" font-size="9.00">选择控制</text>
</g>
<!-- MEMWB_INST&#45;&gt;WB_CTRL -->
<g id="edge6" class="edge">
<title>MEMWB_INST&#45;&gt;WB_CTRL</title>
<path fill="none" stroke="#4169e1" stroke-width="1.5" stroke-dasharray="5,2" d="M155,-147.42C168.44,-146.6 182.73,-145.75 196,-145 214.43,-143.96 234.51,-142.9 252.71,-141.96"/>
<polygon fill="#4169e1" stroke="#4169e1" stroke-width="1.5" points="253.08,-145.44 262.89,-141.44 252.72,-138.45 253.08,-145.44"/>
<text text-anchor="middle" x="219" y="-147.8" font-family="Arial" font-size="9.00">类型</text>
</g>
<!-- MEMWB_RD -->
<g id="node6" class="node">
<title>MEMWB_RD</title>
<ellipse fill="#e6f3ff" stroke="#4682b4" stroke-width="2" cx="97" cy="-37" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="97" y="-40" font-family="Arial" font-size="10.00">MEM_WB_rd</text>
<text text-anchor="middle" x="97" y="-29" font-family="Arial" font-size="10.00">目标寄存器</text>
</g>
<!-- MEMWB_RD&#45;&gt;WB_CTRL -->
<g id="edge7" class="edge">
<title>MEMWB_RD&#45;&gt;WB_CTRL</title>
<path fill="none" stroke="#4169e1" stroke-width="1.5" d="M142.05,-50.19C156.3,-54.94 172.02,-60.69 186,-67 211.95,-78.71 239.54,-94.11 262.27,-107.66"/>
<polygon fill="#4169e1" stroke="#4169e1" stroke-width="1.5" points="260.67,-110.79 271.05,-112.95 264.29,-104.79 260.67,-110.79"/>
<text text-anchor="middle" x="219" y="-96.8" font-family="Arial" font-size="9.00">rd</text>
</g>
<!-- WB_DATA -->
<g id="node9" class="node">
<title>WB_DATA</title>
<ellipse fill="#e6ffe6" stroke="#2e8b57" stroke-width="2" cx="481.57" cy="-211" rx="48.17" ry="21.43"/>
<text text-anchor="middle" x="481.57" y="-214" font-family="Arial" font-size="10.00">wb_data</text>
<text text-anchor="middle" x="481.57" y="-203" font-family="Arial" font-size="10.00">写回数据</text>
</g>
<!-- WB_MUX&#45;&gt;WB_DATA -->
<g id="edge8" class="edge">
<title>WB_MUX&#45;&gt;WB_DATA</title>
<path fill="none" stroke="#ff8c00" stroke-width="2" d="M366.25,-211C384.36,-211 404.76,-211 423.26,-211"/>
<polygon fill="#ff8c00" stroke="#ff8c00" stroke-width="2" points="423.31,-214.5 433.31,-211 423.31,-207.5 423.31,-214.5"/>
<text text-anchor="middle" x="395.5" y="-213.8" font-family="Arial" font-size="9.00">数据</text>
</g>
<!-- WB_RD -->
<g id="node10" class="node">
<title>WB_RD</title>
<ellipse fill="#e6ffe6" stroke="#2e8b57" stroke-width="2" cx="481.57" cy="-91" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="481.57" y="-94" font-family="Arial" font-size="10.00">wb_rd</text>
<text text-anchor="middle" x="481.57" y="-83" font-family="Arial" font-size="10.00">目标寄存器</text>
</g>
<!-- WB_CTRL&#45;&gt;WB_RD -->
<g id="edge10" class="edge">
<title>WB_CTRL&#45;&gt;WB_RD</title>
<path fill="none" stroke="#ff8c00" stroke-width="1.5" d="M363.08,-124.86C382.95,-119.13 405.97,-112.5 426.34,-106.63"/>
<polygon fill="#ff8c00" stroke="#ff8c00" stroke-width="1.5" points="427.46,-109.95 436.1,-103.81 425.52,-103.22 427.46,-109.95"/>
<text text-anchor="middle" x="395.5" y="-119.8" font-family="Arial" font-size="9.00">地址</text>
</g>
<!-- WB_EN -->
<g id="node11" class="node">
<title>WB_EN</title>
<ellipse fill="#e6ffe6" stroke="#2e8b57" stroke-width="2" cx="481.57" cy="-151" rx="38.78" ry="21.43"/>
<text text-anchor="middle" x="481.57" y="-154" font-family="Arial" font-size="10.00">wb_en</text>
<text text-anchor="middle" x="481.57" y="-143" font-family="Arial" font-size="10.00">写使能</text>
</g>
<!-- WB_CTRL&#45;&gt;WB_EN -->
<g id="edge9" class="edge">
<title>WB_CTRL&#45;&gt;WB_EN</title>
<path fill="none" stroke="#ff8c00" stroke-width="1.5" d="M363.08,-142.54C385.11,-144.12 411.02,-145.99 432.89,-147.56"/>
<polygon fill="#ff8c00" stroke="#ff8c00" stroke-width="1.5" points="432.71,-151.06 442.94,-148.29 433.22,-144.08 432.71,-151.06"/>
<text text-anchor="middle" x="395.5" y="-147.8" font-family="Arial" font-size="9.00">使能</text>
</g>
<!-- RF -->
<g id="node12" class="node">
<title>RF</title>
<path fill="#ffebcd" stroke="#d2691e" stroke-width="2" d="M685.14,-175.96C685.14,-179.02 667.88,-181.5 646.64,-181.5 625.39,-181.5 608.14,-179.02 608.14,-175.96 608.14,-175.96 608.14,-126.04 608.14,-126.04 608.14,-122.98 625.39,-120.5 646.64,-120.5 667.88,-120.5 685.14,-122.98 685.14,-126.04 685.14,-126.04 685.14,-175.96 685.14,-175.96"/>
<path fill="none" stroke="#d2691e" stroke-width="2" d="M685.14,-175.96C685.14,-172.9 667.88,-170.41 646.64,-170.41 625.39,-170.41 608.14,-172.9 608.14,-175.96"/>
<text text-anchor="middle" x="646.64" y="-160.2" font-family="Arial" font-size="11.00">寄存器堆</text>
<text text-anchor="middle" x="646.64" y="-148.2" font-family="Arial" font-size="11.00">Register File</text>
<text text-anchor="middle" x="646.64" y="-136.2" font-family="Arial" font-size="11.00">32 × 32&#45;bit</text>
</g>
<!-- WB_DATA&#45;&gt;RF -->
<g id="edge11" class="edge">
<title>WB_DATA&#45;&gt;RF</title>
<path fill="none" stroke="#228b22" stroke-width="2" d="M519.16,-197.53C542.65,-188.9 573.36,-177.59 598.64,-168.29"/>
<polygon fill="#228b22" stroke="#228b22" stroke-width="2" points="599.86,-171.57 608.03,-164.84 597.44,-165 599.86,-171.57"/>
<text text-anchor="middle" x="573.14" y="-184.8" font-family="Arial" font-size="9.00">写数据</text>
</g>
<!-- WB_RD&#45;&gt;RF -->
<g id="edge12" class="edge">
<title>WB_RD&#45;&gt;RF</title>
<path fill="none" stroke="#228b22" stroke-width="1.5" d="M522.46,-105.68C545.42,-114.12 574.39,-124.79 598.47,-133.65"/>
<polygon fill="#228b22" stroke="#228b22" stroke-width="1.5" points="597.52,-137.03 608.12,-137.19 599.94,-130.46 597.52,-137.03"/>
<text text-anchor="middle" x="573.14" y="-131.8" font-family="Arial" font-size="9.00">地址</text>
</g>
<!-- WB_EN&#45;&gt;RF -->
<g id="edge13" class="edge">
<title>WB_EN&#45;&gt;RF</title>
<path fill="none" stroke="#228b22" stroke-width="1.5" d="M520.8,-151C543.78,-151 573.23,-151 597.75,-151"/>
<polygon fill="#228b22" stroke="#228b22" stroke-width="1.5" points="597.93,-154.5 607.93,-151 597.93,-147.5 597.93,-154.5"/>
<text text-anchor="middle" x="573.14" y="-153.8" font-family="Arial" font-size="9.00">使能</text>
</g>
<!-- note -->
<g id="node13" class="node">
<title>note</title>
<polygon fill="#ffebcd" stroke="transparent" stroke-width="2" points="178,-496 16,-496 16,-422 178,-422 178,-496"/>
<text text-anchor="start" x="28" y="-480.8" font-family="Arial" font-size="9.00">• x0 寄存器恒为 0，不可写入</text>
<text text-anchor="start" x="28" y="-464.8" font-family="Arial" font-size="9.00">• JAL/JALR 指令写回 PC+4</text>
<text text-anchor="start" x="28" y="-448.8" font-family="Arial" font-size="9.00">• Load 指令写回存储器数据</text>
<text text-anchor="start" x="28" y="-432.8" font-family="Arial" font-size="9.00">• 其他指令写回 ALU 结果</text>
</g>
</g>
</svg>
