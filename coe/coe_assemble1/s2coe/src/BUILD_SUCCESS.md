# âœ… æ„å»ºæˆåŠŸï¼

## ğŸ‰ æ–‡ä»¶å·²ç”Ÿæˆ

æ‰€æœ‰æµ‹è¯•æ–‡ä»¶å·²æˆåŠŸç”Ÿæˆåœ¨ `test_output\` ç›®å½•ï¼š

- âœ… `rv32i_test.o` - ç›®æ ‡æ–‡ä»¶
- âœ… `rv32i_test.elf` - å¯æ‰§è¡Œæ–‡ä»¶  
- âœ… `rv32i_test.bin` - äºŒè¿›åˆ¶æ–‡ä»¶
- âœ… `rv32i_test.mem` - å†…å­˜åˆå§‹åŒ–æ–‡ä»¶
- âœ… `rv32i_test.coe` - Xilinx COE æ–‡ä»¶ï¼ˆç”¨äº FPGAï¼‰
- âœ… `rv32i_test.asm` - åæ±‡ç¼–æ–‡ä»¶ï¼ˆç”¨äºè°ƒè¯•ï¼‰

## ğŸ“‹ æµ‹è¯•å†…å®¹

æ€»å…± **34 ä¸ªæµ‹è¯•ç”¨ä¾‹**ï¼Œæ¶µç›–ä»¥ä¸‹ RV32I æŒ‡ä»¤ï¼š

### æŒ‡ä»¤ç±»å‹åˆ†å¸ƒ
1. **LUI, AUIPC** (3 tests)
2. **ADDI, ADD, SUB, SLTI** (4 tests)  
3. **ANDI, ORI, XORI, AND, OR, XOR** (6 tests)
4. **SLLI, SRLI, SRAI, SLL, SRL, SRA** (6 tests)
5. **SLT, SLTU, SLTIU** (3 tests)
6. **SW/LW, SH/LH, SB/LB, LBU/LHU** (4 tests)
7. **BEQ, BNE, BLT, BGE, BLTU, BGEU** (6 tests)
8. **JAL, JALR** (2 tests)

## ğŸš€ ä¸‹ä¸€æ­¥ï¼šä¸Šæ¿æµ‹è¯•

### 1. åŠ è½½åˆ° FPGA

å°† `test_output\rv32i_test.coe` æ–‡ä»¶åŠ è½½åˆ°ä½ çš„ Vivado é¡¹ç›®ï¼š
```
1. æ‰“å¼€ Vivado é¡¹ç›®
2. æ‰¾åˆ° IROM/Block RAM IP
3. åœ¨ COE File é€‰é¡¹ä¸­é€‰æ‹© rv32i_test.coe
4. é‡æ–°ç»¼åˆå’Œå®ç°
5. ç”Ÿæˆæ¯”ç‰¹æµå¹¶ä¸‹è½½åˆ° FPGA
```

### 2. è¿æ¥ LED è¾“å‡º

åœ¨ä½ çš„ Verilog/VHDL ä»£ç ä¸­ï¼Œå°†ä»¥ä¸‹åœ°å€æ˜ å°„åˆ° LEDï¼š

**ä¸»è¾“å‡ºåœ°å€ï¼š`0xFFFFFFFC`**
```verilog
// ä¾‹å¦‚åœ¨å†…å­˜æ§åˆ¶å™¨ä¸­
always @(posedge clk) begin
    if (write_enable && addr == 32'hFFFFFFFC) begin
        led_output <= wdata[7:0];  // å°†å†™å…¥çš„æ•°æ®è¾“å‡ºåˆ° LED
    end
end
```

**è°ƒè¯•è¾“å‡ºåœ°å€ï¼š`0x2000`** (å¯é€‰)
```verilog
// ç”¨äºè°ƒè¯•æ—¶æŸ¥çœ‹ä¸­é—´ç»“æœ
if (write_enable && addr == 32'h00002000) begin
    debug_register <= wdata;
end
```

### 3. é¢„æœŸç»“æœ

âœ… **å…¨éƒ¨é€šè¿‡**ï¼šLED æ˜¾ç¤º `0x22` (åè¿›åˆ¶ 34)
- äºŒè¿›åˆ¶ï¼š`00100010`
- è¡¨ç¤º 34 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡

âŒ **æµ‹è¯•å¤±è´¥**ï¼šLED æ˜¾ç¤º `0xFF`
- äºŒè¿›åˆ¶ï¼š`11111111`  
- è¡¨ç¤ºæŸä¸ªæµ‹è¯•å¤±è´¥

âš ï¸ **éƒ¨åˆ†é€šè¿‡**ï¼šLED æ˜¾ç¤º 0-33 ä¹‹é—´çš„å€¼
- è¡¨ç¤ºé€šè¿‡çš„æµ‹è¯•æ•°é‡
- å¯ä»¥æ ¹æ®è¿™ä¸ªæ•°å­—å®šä½å¤±è´¥çš„æµ‹è¯•

### 4. è°ƒè¯•æ–¹æ³•

å¦‚æœæµ‹è¯•æœªå…¨éƒ¨é€šè¿‡ï¼š

#### æ–¹æ³• 1ï¼šæŸ¥çœ‹åæ±‡ç¼–
æ‰“å¼€ `test_output\rv32i_test.asm` æ–‡ä»¶ï¼š
- æ‰¾åˆ°å¤±è´¥æµ‹è¯•å¯¹åº”çš„ä»£ç æ®µ
- æ£€æŸ¥æŒ‡ä»¤ç¼–ç æ˜¯å¦æ­£ç¡®

#### æ–¹æ³• 2ï¼šä»¿çœŸéªŒè¯
åœ¨ Vivado æˆ– ModelSim ä¸­ä»¿çœŸï¼š
```tcl
# è®¾ç½®æ–­ç‚¹åœ¨åœ°å€ 0x39C (fail_halt)
# æŸ¥çœ‹å¯„å­˜å™¨ x31 (t6) çš„å€¼
# è¯¥å€¼è¡¨ç¤ºå·²é€šè¿‡çš„æµ‹è¯•æ•°
```

#### æ–¹æ³• 3ï¼šå•æ­¥æ‰§è¡Œ
- ä»æµ‹è¯• 1 å¼€å§‹é€ä¸ªéªŒè¯
- æ¯ä¸ª `pass_N` æ ‡ç­¾ä¼šå¢åŠ  x31 è®¡æ•°å™¨

## ğŸ” æµ‹è¯•åºåˆ—

| åºå· | æµ‹è¯•åç§° | åœ°å€ | æµ‹è¯•æŒ‡ä»¤ |
|------|---------|------|---------|
| 1 | test_lui | 0x08 | LUI |
| 2-3 | test_auipc | 0x1C | AUIPC |
| 4 | test_addi | 0x40 | ADDI |
| 5 | test_add | 0x58 | ADD |
| 6 | test_sub | 0x70 | SUB |
| 7 | test_slti | 0x88 | SLTI |
| 8 | test_andi | 0xA0 | ANDI |
| 9 | test_ori | 0xB8 | ORI |
| 10 | test_xori | 0xD0 | XORI |
| 11 | test_and | 0xE8 | AND |
| 12 | test_or | 0x100 | OR |
| 13 | test_xor | 0x118 | XOR |
| ... | ... | ... | ... |

ï¼ˆæŸ¥çœ‹ `rv32i_test.asm` è·å–å®Œæ•´åœ°å€æ˜ å°„ï¼‰

## âš™ï¸ å·¥å…·é“¾ä¿¡æ¯

- **å·¥å…·é“¾è·¯å¾„**: `D:\gnu-mcu-eclipse-riscv-none-gcc\RISC-V Embedded GCC\bin`
- **æ±‡ç¼–å™¨**: `riscv-none-embed-as`
- **ç‰ˆæœ¬**: GNU assembler 2.29
- **æ¶æ„**: RV32I (32-bit RISC-V Integer)
- **ABI**: ilp32

## ğŸ› å¸¸è§é—®é¢˜

### Q: å¦‚ä½•é‡æ–°ç¼–è¯‘ï¼Ÿ
**A**: è¿è¡Œ `.\build_rv32i_test.bat`

### Q: å¦‚ä½•ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ï¼Ÿ
**A**: ç¼–è¾‘ `rv32i_test.s` æ–‡ä»¶ï¼Œç„¶åé‡æ–°è¿è¡Œæ„å»ºè„šæœ¬

### Q: å¦‚ä½•æ·»åŠ æ›´å¤šæµ‹è¯•ï¼Ÿ
**A**: åœ¨ `rv32i_test.s` ä¸­ï¼š
1. æ·»åŠ æ–°çš„æµ‹è¯•æ®µ
2. æµ‹è¯•é€šè¿‡åæ·»åŠ  `addi x31, x31, 1`
3. æµ‹è¯•å¤±è´¥æ—¶è·³è½¬åˆ° `fail_halt`
4. æ›´æ–°æ–‡æ¡£ä¸­çš„é¢„æœŸé€šè¿‡æ•°

### Q: LED æ²¡æœ‰ä»»ä½•æ˜¾ç¤º
**A**: æ£€æŸ¥ï¼š
1. æ—¶é’Ÿå’Œå¤ä½ä¿¡å·
2. åœ°å€è¯‘ç é€»è¾‘
3. å†…å­˜æ˜ å°„é…ç½®
4. LED è¾“å‡ºç«¯å£è¿æ¥

### Q: å¯„å­˜å™¨ä½ç½®è§£ç é—®é¢˜
**A**: å¦‚ä¹‹å‰åˆ†æï¼Œå¯èƒ½æ˜¯å­—èŠ‚åºé—®é¢˜ï¼š
- æ£€æŸ¥ COE æ–‡ä»¶åŠ è½½æ–¹å¼
- éªŒè¯å¤„ç†å™¨çš„å­—èŠ‚åºé…ç½®
- æŸ¥çœ‹ `rv32i_test.asm` ç¡®è®¤ç¼–ç æ­£ç¡®

## ğŸ“Š å†…å­˜å¸ƒå±€

```
0x00000000 - 0x000003AF: æµ‹è¯•ä»£ç  (.text)
0x00001000:              å†…å­˜æµ‹è¯•åŸºå€
0x00002000:              è°ƒè¯•è¾“å‡ºåŒºåŸŸ
0xFFFFFFFC:              LED è¾“å‡ºåœ°å€
```

## ğŸ¯ æˆåŠŸæ ‡å‡†

- âœ… ç¼–è¯‘æ— é”™è¯¯
- âœ… ç”Ÿæˆæ‰€æœ‰è¾“å‡ºæ–‡ä»¶
- âœ… åæ±‡ç¼–æŒ‡ä»¤æ­£ç¡®
- âœ… ä¸Šæ¿å LED æ˜¾ç¤º 0x22
- âœ… æ— å¼‚å¸¸æˆ–æ­»é”

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** ğŸ‰

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `rv32i_test.asm` - åæ±‡ç¼–
- `RV32I_TEST_README.md` - è¯¦ç»†æ–‡æ¡£
